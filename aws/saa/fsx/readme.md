# Amazon FSx
Amazon FSxはファイル共有に適したファイルストレージサービスです。  
ファイルストレージとはデータをファイルやフォルダの単位で階層構造として管理するストレージ形式のことをいいます。  
FSxは、EFSと同様に主に複数のEC2インスタンスやオンプレミスからアクセスされるファイル共有ストレージとして利用されます。

## 種類
FSxには複数のファイルシステム（ストレージ上のファイルを管理する仕組み）が提供されています。下記はFSxの主要なファイルシステムです。
* Amazon FSx For Windowsファイルサーバー
* Amazon FSx For Lustre
* Amazon FSx for NetApp ONTAP

それぞれ既存の「Windowsファイルサーバー」「Lustre（ラスター）」「NetApp ONTAP」のファイルシステムをAWS上で利用できるようにしたサービスです。いずれもフルマネージドサービスなので、ユーザーはインフラの設定や管理・運用を意識する必要がありません。  
さらに、Amazon CloudWatchと連携した容量監視やAWS CloudTrailによる操作ログの取得など、他のAWSサービスと連携した運用も可能です。

## Amazon FSx For Lustre
Amazon FSx For Lustreは、Lustreファイルシステムを提供するストレージサービスです。  
LustreはLinuxOS用に設計されたオープンソースのファイルシステムで、主にスーパーコンピューターなどのHPC（High Performance Computing）や機械学習の分野で利用されています。大量のクライアントから低レイテンシーかつ高スループットにファイルアクセスを行う必要のあるシステムで利用されます。

### Amazon S3と連携できる
S3バケットをFSx for Lustreファイルシステムに統合すると、ファイルシステムとS3バケット間でデータを自動的にインポートおよびエクスポートします。これにより、S3に保存されているデータをFSx for Lustreから透過的に利用できるようになります。

FSx For LustreとS3を連携することで、アクティブにデータを扱う際はFSx For Lustreファイルシステム上に保存し、そうでない場合はS3へ保存してLustreファイルシステムの容量を削減するなど、ストレージを階層的に利用できます。ストレージへの保存料金はS3の方が安価なため、階層型ストレージを実現することによりコストを抑えた運用ができます。

### POSIXに準拠したファイルシステムである
FSx For LustreはPOSIX（※）に準拠しているため、Linuxの既存のファイルシステムと同様に利用できます。また、既存のアプリケーションをFSx For Lustreで動作させるために特別な対応をする必要もありません。  
（※）POSIX ... Linuxを含めたUNIX系OSにおけるプログラミングに関する標準規格


## Amazon FSx for NetApp ONTAP
Amazon FSx for NetApp ONTAPは、AWSクラウド上でフルマネージドのNetApp ONTAPファイルシステムを提供するストレージサービスです。NetApp ONTAPは、NetApp社のストレージ専用OSで高度なデータ管理機能を備えています。

このサービスにより、以下のようなONTAPファイルシステムの特徴を活用することができます。
* 幅広い接続性
  * NFS、SMB、及びiSCSIプロトコルによるアクセスをサポートしています。
* 高パフォーマンスと拡張性
  * 高速で低レイテンシーのアクセスができ、またストレージの拡張機能を備えています。
* データ管理
  * データ圧縮や重複除去などデータ容量を効率化できる機能が利用できます。
* 可用性とデータ保護
  * マルチAZ配置、クロスリージョンレプリケーション、スナップショットなどの機能があります。

### 特徴
FSx for NetApp ONTAPは、NFSとSMBの両プロトコルをサポートする共有ファイルストレージを提供し、同じデータに対するマルチプロトコルアクセス(NFSとSMBの同時アクセス)が可能です。  
これにより、異なるプロトコルを使用するアプリケーションが同一ファイルシステムのデータを共有できます。SMBでアクセスする場合、FSx for NetApp ONTAP側とWindowsインスタンス側のいずれもActive Directory(AD)に参加する必要があります。

### 利用用途
FSx for NetApp ONTAPの主な利用用途には、ファイル共有、アプリケーションのストレージ、データ保護とレプリケーション、データ移行などがあります。

### NetApp SnapMirror
NetApp SnapMirrorは、FSx for NetApp ONTAPに標準搭載されたデータレプリケーション機能です。  
スナップショットを利用し、変更されたデータのみを転送する差分同期方式により、継続的かつ自動的なレプリケーションを実現します。プライマリの更新内容は定期的かつ高頻度でセカンダリへ同期されるため、障害発生時にも最新に近いデータをセカンダリで即座に利用できます。  
さらに、SMB/NFSの両プロトコルを一括してレプリケートできるため、セカンダリでも同様の環境でアクセスが可能です。
