# Amazon Route 53
AWSが提供するDNS（Domain Name System）運用サービス。  
非常に柔軟なDNSサービスであり、AWS上で運営しているサービスだけでなく、オンプレミスサーバーなどAWS外のリソースに対しても使用することができる。

## 特徴
* 権威DNSサーバー
* ドメイン名の購入
* ドメイン名の登録・管理

## Route 53 Resolver
VPCにデフォルトで提供されるDNSサーバーで、インターネット上に公開されたリソースの名前解決と、VPC内のリソースの名前解決ができる。

オンプレミス環境など他のネットワークとVPCをプライベートネットワークで接続する場合、VPC内のリソースはオンプレミス環境にある内部DNSサーバーを参照できない。  
また、オンプレミス環境にある内部DNSサーバーもVPC内のRoute 53 Resolverを参照できない。  

このようなハイブリッド環境では、Route 53 Resolverのハイブリッドクラウド機能を利用して名前解決を一元化できる。VPC内のリソースがオンプレミス内部のホスト名を解決し、逆にオンプレミスのリソースがVPC内のプライベートDNSホスト名を解決できるようになる。

要は、内部トラフィックの管理に有効。

### ハイブリッド環境
オンプレミス環境など他のネットワークとVPCをプライベートネットワークで接続する場合、VPC内のリソースはオンプレミス環境にある内部DNSサーバーを参照できない。  
また、オンプレミス環境にある内部DNSサーバーもVPC内のRoute 53 Resolverを参照できない。  

このようなハイブリッド環境では、Route 53 Resolverのハイブリッドクラウド機能を利用して名前解決を一元化できる。  
これにより、VPC内のリソースがオンプレミス内部のホスト名を解決し、逆にオンプレミスのリソースがVPC内のプライベートDNSホスト名を解決できるようになります。

## Route 53のヘルスチェック
ルーティングポリシーのうちシンプルルーティングポリシー以外は、ヘルスチェックが利用できる。  
Route 53のヘルスチェックは、ドメイン名に対応するリソースが正常に動作しているかを定期的に確認する。その結果、正常であったリソースのIPアドレスのみDNSクエリの回答とします。  
複数値回答ルーティングポリシーとフェイルオーバールーティングポリシーはヘルスチェックの結果に基づいて回答するので、ヘルスチェックの設定が必須になる。

## Route 53へのDNSサービスの移行
以下の手順で行われる。
1. Route 53でパブリックホストゾーンの作成  
Route 53ではゾーン情報を「ホストゾーン」で管理する。管理対象となるドメイン名がホストゾーンの名前になる。パブリックホストゾーンは公開インターネット向けの設定になる。

2. 既存のDNSレコードの移行  
ゾーンファイルをインポートして、既存のDNSプロバイダーにある全てのDNS情報をRoute 53に移行する。

3. ドメインのネームサーバーの更新  
既存のDNSプロバイダーのネームサーバーからRoute 53のネームサーバーに情報を更新する。

## フェイルオーバールーティングポリシー
通常時にアクセスさせたいリソースをプライマリに設定し、プライマリに障害が発生した場合にアクセスさせたいリソースをセカンダリに設定します。通常時はプライマリに設定したリソースのIPアドレスを回答しますが、プライマリのリソースにヘルスチェックで異常が発生した場合は、セカンダリに設定したリソースのIPアドレスを回答します。  
このようにサービスを提供するリソースがプライマリからセカンダリへ自動的に切り替わる仕組みのことを「フェイルオーバー」と言います。

### 例
Webサービスを公開するEC2インスタンスのIPアドレスをプライマリに設定し、S3の静的Webサイトホスティングのソーリーページ（ユーザーへメンテナンス中であることを伝えるためのページ）のURLをセカンダリに設定することで、EC2インスタンスに障害が発生した場合は設定したソーリーページを表示させることができます。
